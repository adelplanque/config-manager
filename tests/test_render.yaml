files:
  global/config.ini: |
    [group]
    command = my_command
    subcommands = item1 item2 item3
  templates/tmpl_single.txt: |
    command: {{settings.config.group.command}}
  templates/tmpl_split.txt: |
    {% for value in config.group.subcommands.split() %}
    {{settings.config.group.command}}.{{item}}
    {% endfor %}

tests:
  - command: >-
      env CONFIG_PATH=${WORKDIR}/global
      ${CONFIG_MANAGER} render ${WORKDIR}/templates/tmpl_single.txt
    expected: |
      command: my_command
  # - command: >-
  #     env CONFIG_PATH=${WORKDIR}/global
  #     valgrind ${CONFIG_MANAGER} render ${WORKDIR}/templates/tmpl4.txt
  #   expected: |
  #     my_command.item1
  #     my_command.item2
  #     my_command.item3
